# Bootleg AES

## Description  
![image](https://github.com/KenTranR3/HCMUS-CTF-2023-Quals/blob/main/Crypto/Bootleg%20AES/Description.png)

## Write Up
* This is a simple Cryptography challenge for dealing AES. 
* Reading the enc.sh source code, we can understand:
    - ``` echo "$(cat pad.bin)$FLAG" > flag.bin ``` put the $flag to new file called flag.bin
    - ``` ls -alF ./pad.bin ``` print out all roles and the user of the file 
    - ``` x=$(openssl rand -hex 32) echo $x ``` x is an 32bits hexadecimal generated by openssl then print out the x 
    - ``` openssl enc -aes-256-cbc -K $x -iv $(openssl rand -hex 16) -in flag.bin -out ciphertext.bin ``` using openssl with encrypt AES-256-cbc to encrypted the flag and send it to ciphertext.bin
* enc.sh is a sh file to encrypt the flag we need, ciphertext.bin is the encrypted flag, log.txt to print out the all roles and the x
* When I read about AES-CBC in Wiki, I found this note:
> Decrypting with the incorrect IV causes the first block of plaintext to be corrupt but subsequent plaintext blocks will be correct.
* So we can just use the key in log.txt and any kind of IV with the same length can print out the flag.
```
#!/bin/bash

echo "$(cat pad.bin)$FLAG" > flag.bin
ls -alF ./pad.bin
x=$(openssl rand -hex 32)
echo $x
openssl enc -aes-256-cbc -K $x -iv $(openssl rand -hex 16) -in flag.bin -out ciphertext.bin -nopad
```

```
x�F�<ܸk;L��VB4�����)َ�:��C��2@[0�O�(�b�wJ<H�^��]T�a}U^&�&

 �\|�S9��HCMUS-CTF{it5_c4ll3d_pr1v4t3_k3y_crypt09raphy_f0r_4_r3450n}
```


